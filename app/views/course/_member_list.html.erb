<div id="div_6" class="tab_content">

  <div class="titleTextParticipants">Participants:&nbsp;&nbsp;
    <span><input type="text" name="add_people_email[]" class="dd_select brown_bg" id="add_course_people" /></span>
    <span style="float:right; margin-right:89px;""><a href="javascript:void(0)" name="btn_add_people" id="btn_add_people" class="big_blue_btn btn_add">ADD</a></span>
  </div> 
  
  <div class="frm_input">
    <div class="frm_input" id="add_people_container"></div>
  </div>
  
  <div class="frm_label small_label">
    &nbsp;
  </div>
  <div id="course_people" class="frm_input">
    <% if @peoples %>
      <%= render :partial => "/course/participant_list", :locals => {:peoples=>@peoples, :mode=>"list"} %>
    <% end %>
  </div>
  <div id="course_participant_list" class="hide">
      <div class="participant_close">
        <a href="javascript:void(0)" onClick="javascript:$('#course_participant_list').hide();" class="big_blue_btn">Close</a>
      </div>
      <div id="course_participant_list_inner">
         Loading...
      </div>
  </div>
  <div class="clear"></div>
</div> 
<script type="text/javascript">
//List people (participants)
  $("#btn_add_people").click(function() {
    course_id = $("#course_id_hdn").val();
    email_id = $("#add_course_people").val();
    node_class = "even";
    dataString = {course_id:course_id, email:email_id};
    if (course_id && email_id) {
        showSpinner(true); 
        $.ajax({  
          type: "POST",  
          url: "/course/add_participant",  
          data: dataString,
          dataType: "json",
          success: function(data) {
            if (data.status) {
              participant_node = $('<li id="'+ data.profile.full_name + '" class="'+node_class+'"></li>');
              participant_node.className = node_class;
              participant_node.id = data.profile.full_name;
              partcipant_html = '<div class="avatar_white_bdrC2"><img src='+data.profile.image_file_name+'></div>';
              partcipant_html += '<div class="people_name">' + data.profile.full_name + '</div>';
               partcipant_html += '<div class="people_name">Pending</div>';
              partcipant_html += '<div class="people_delete"><a href="javascript:void(0)" rel="'+data.profile.full_name+'">Delete</a></div><div class="clear"></div>';
              participant_node.append(partcipant_html);
              $("#course_people ul").prepend(participant_node);
              $("#course_participant_list").hide();
              $("#hdn_is_page_change").val(true);
            } 
            else {
              if(data.already_added) {
                alert("This participant is already added to this course!!");
              } else {
                alert("ERROR");
                $("#course_participant_list").hide();
              }
            }
            showSpinner(false);
          }
        });
     } else {
      alert("Please insert participant name");
    }
  });
  
  //Delete participant 
  $(".people_node").delegate("li .people_delete a", "click", function(){
    showSpinner(true);
    profile_id = $(this).attr("rel");
    course_id = $("#course_id_hdn").val(); 
    dataString = {course_id:course_id, profile_id:profile_id};
    if(profile_id) {
      $.ajax({  
        type: "POST",  
        url: "/course/delete_participant",  
        data: dataString,
        success: function(data) {
          if (data) {
            $("#"+profile_id).remove();
          } else {
            alert("ERROR");
          }
          showSpinner(false);
        }
      });
    }
  });
</script>